PCFET0NUWVBFIGh0bWw-CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ-CiAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAsIG1heGltdW0tc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vIj4KICA8bWV0YSBjaGFyc2V0PSJVVEYtOCIgLz4KICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCIgLz4KICA8dGl0bGU-RnVuRmFydCBHcmFiIChXZWIgVmVyc2lvbik8L3RpdGxlPgogIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2V0aGVyc0A1L2Rpc3QvZXRoZXJzLnVtZC5taW4uanMiPjwvc2NyaXB0PgogIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL3BoYXNlckAzLjg1LjIvZGlzdC9waGFzZXIuanMiPjwvc2NyaXB0PgogIDxzdHlsZT4KICAgIGJvZHkgeyBtYXJnaW46IDA7IHBhZGRpbmc6IDA7IG92ZXJmbG93OiBoaWRkZW47IGJhY2tncm91bmQ6IGJsYWNrOyB9CiAgICBjYW52YXMgeyBkaXNwbGF5OiBibG9jazsgbWFyZ2luOiBhdXRvOyB9CiAgICAjcXVpdFBvcHVwIGJ1dHRvbiB7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0NDQ7CiAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgcGFkZGluZzogMTBweDsKICAgICAgYm9yZGVyOiBub25lOwogICAgICBib3JkZXItcmFkaXVzOiA0cHg7CiAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIH0KICAgICNxdWl0UG9wdXAgYnV0dG9uOmhvdmVyIHsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzQ0NDsKICAgIH0KICA8L3N0eWxlPgo8L2hlYWQ-Cjxib2R5Pgo8c2NyaXB0PgogIGNvbnN0IGNvbmZpZyA9IHsKICB0eXBlOiBQaGFzZXIuQVVUTywKICB3aWR0aDogODAwLAogIGhlaWdodDogNjAwLAogIHNjYWxlOiB7CiAgICBtb2RlOiBQaGFzZXIuU2NhbGUuRklULAogICAgYXV0b0NlbnRlcjogUGhhc2VyLlNjYWxlLkNFTlRFUl9CT1RILAogICAgcGFyZW50OiAnZ2FtZS1jb250YWluZXInLCAvLyBPcHRpb25hbDogaWYgeW91J3JlIG1vdW50aW5nIHRvIGEgZGl2CiAgfSwKICBiYWNrZ3JvdW5kQ29sb3I6ICcjZmZmZmZmJywKICBwaHlzaWNzOiB7CiAgICBkZWZhdWx0OiAnYXJjYWRlJywKICAgIGFyY2FkZTogewogICAgICBncmF2aXR5OiB7IHk6IDAgfSwKICAgICAgZGVidWc6IGZhbHNlCiAgICB9CiAgfSwKICBzY2VuZTogewogICAgcHJlbG9hZCwKICAgIGNyZWF0ZSwKICAgIHVwZGF0ZQogIH0KfTsKCiAgY29uc3QgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZShjb25maWcpOwoKICBsZXQgY2xhdywgY2xhd0hpdGJveCwgb3ZlcmxheSwgb3ZlcmxheUxlZnQsIG92ZXJsYXlSaWdodCwgcHJpemVHcm91cCwgZmFsbGluZ0dyb3VwLCBwcml6ZUJveCwgdmljdG9yeSA9IGZhbHNlOwogIGxldCBjbGF3RHJvcHBpbmcgPSBmYWxzZSwgY2xhd1JldHJhY3RpbmcgPSBmYWxzZSwgaG9sZGluZ09iamVjdCA9IGZhbHNlOwogIGxldCBhdHRhY2hlZFByaXplID0gbnVsbCwgbW92ZUxlZnQgPSBmYWxzZSwgbW92ZVJpZ2h0ID0gZmFsc2U7CiAgbGV0IHN0YXJ0TWVudUltYWdlLCBxdWl0UG9wdXAsIGxlZnRCdXR0b24sIHJpZ2h0QnV0dG9uOwoKICBmdW5jdGlvbiBwcmVsb2FkKCkgewogICAgdGhpcy5sb2FkLmltYWdlKCdiYWNrZ3JvdW5kJywgJ2h0dHBzOi8vbWFnZW50YS1icm9hZC1vcmNhLTg3My5teXBpbmF0YS5jbG91ZC9pcGZzL2JhZnliZWlnc2pqYnM2bmpuanNieDR0M2tmd212d3pqbjRtbHQ2N2NyamNvYzdxZzVpc21teXNuZm5xJyk7CiAgICB0aGlzLmxvYWQuaW1hZ2UoJ2NsYXcnLCAnaHR0cHM6Ly9tYWdlbnRhLWJyb2FkLW9yY2EtODczLm15cGluYXRhLmNsb3VkL2lwZnMvYmFma3JlaWNwaDVkcW12bHN4dm43a2JwZDNpcGYzcWF1bDdzdW5ibTN6aGJ4NXR2ZjNvZmdlY2xqc3EnKTsKICAgIHRoaXMubG9hZC5pbWFnZSgncHJpemUnLCAnaHR0cHM6Ly9tYWdlbnRhLWJyb2FkLW9yY2EtODczLm15cGluYXRhLmNsb3VkL2lwZnMvYmFma3JlaWJ5ZWh2M2p1aGhyN2pnZmJsYXppZ3VlZGVrajdza3Bxem5kYmJ2ZDd4bmo3aXN1eGhlbGEnKTsKICAgIHRoaXMubG9hZC5pbWFnZSgndmljdG9yeUJnJywgJ2h0dHBzOi8vbWFnZW50YS1icm9hZC1vcmNhLTg3My5teXBpbmF0YS5jbG91ZC9pcGZzL2JhZnliZWllNWZ6enJsam5sbmVqcmhtcnFhb2czejRlZG01aG1zbmN1azRrYXlqNXp5aDdlZGZzbzVxJyk7CiAgICB0aGlzLmxvYWQuaW1hZ2UoJ292ZXJsYXlfaWRsZScsICdodHRwczovL21hZ2VudGEtYnJvYWQtb3JjYS04NzMubXlwaW5hdGEuY2xvdWQvaXBmcy9iYWZrcmVpZTMycmh5dmJpYmVlcjVtaW5scGlqYnJpNXB1cXEzNmJhZnN6d3lqbmhjNG96YWtldzNveScpOwogICAgdGhpcy5sb2FkLmltYWdlKCdvdmVybGF5X2xlZnQnLCAnaHR0cHM6Ly9tYWdlbnRhLWJyb2FkLW9yY2EtODczLm15cGluYXRhLmNsb3VkL2lwZnMvYmFma3JlaWc2emt3ZjZzd2dld3dtd2RodWlhdWFscXltYmZwYnNkYzR2M2ozbTQ3c3lnMjZ4M3VjbHEnKTsKICAgIHRoaXMubG9hZC5pbWFnZSgnb3ZlcmxheV9yaWdodCcsICdodHRwczovL21hZ2VudGEtYnJvYWQtb3JjYS04NzMubXlwaW5hdGEuY2xvdWQvaXBmcy9iYWZrcmVpY2hsajJ4Mmw0ZWpveXhhbGU3a2JmbWlzemVzZ2xtMmFmdHNiZG5yY2hqeTRicjVxM24yZScpOwogICAgdGhpcy5sb2FkLmltYWdlKCdzdGFydE1lbnUnLCAnaHR0cHM6Ly9tYWdlbnRhLWJyb2FkLW9yY2EtODczLm15cGluYXRhLmNsb3VkL2lwZnMvYmFmeWJlaWZzM2FxZTVsejVldW1kb3FjeGprNGlwd2N3dnR6Z21sa3RiM3M0amgzd3ppeHE2dm9yd3UnKTsKICB9CgpmdW5jdGlvbiBjcmVhdGUoKSB7CiAgdGhpcy5hZGQuaW1hZ2UoNDAwLCAzMDAsICdiYWNrZ3JvdW5kJyk7CgogIHByaXplR3JvdXAgPSB0aGlzLnBoeXNpY3MuYWRkLmdyb3VwKCk7CiAgZmFsbGluZ0dyb3VwID0gdGhpcy5waHlzaWNzLmFkZC5ncm91cCgpOwoKICBmb3IgKGxldCB4ID0gMjAwOyB4IDwgNjAwOyB4ICs9IDE1MCkgewogICAgY29uc3QgcHJpemUgPSB0aGlzLnBoeXNpY3MuYWRkLmltYWdlKHgsIDU1MCwgJ3ByaXplJykuc2V0SW1tb3ZhYmxlKHRydWUpOwogICAgcHJpemUuYm9keS5zZXRTaXplKDE2LCAyNCkuc2V0T2Zmc2V0KDIwLCAxNCk7CiAgICBwcml6ZS5zZXREZXB0aCgxKTsKICAgIHByaXplR3JvdXAuYWRkKHByaXplKTsKICB9CgogIGNsYXcgPSB0aGlzLmFkZC5pbWFnZSg0MDAsIDUwLCAnY2xhdycpLnNldERlcHRoKDIpOwogIGNsYXdIaXRib3ggPSB0aGlzLnBoeXNpY3MuYWRkLmltYWdlKDQwMCwgNTApLnNldEltbW92YWJsZSh0cnVlKS5zZXRWaXNpYmxlKGZhbHNlKTsKICBjbGF3SGl0Ym94LmJvZHkuc2V0U2l6ZSgyMCwgNDApLnNldE9mZnNldCgtMTAsIC0yMCk7CgogIG92ZXJsYXkgPSB0aGlzLmFkZC5pbWFnZSg0MDAsIDMwMCwgJ292ZXJsYXlfaWRsZScpLnNldERlcHRoKDMpOwoKICBpZiAoIXByaXplQm94IHx8ICFwcml6ZUJveC5ib2R5KSB7CiAgICBwcml6ZUJveCA9IHRoaXMuYWRkLnJlY3RhbmdsZSg3NzAsIDc3MCwgNDAsIDEwLCAweDAwZmYwMCwgMC4yKTsKICAgIHRoaXMucGh5c2ljcy5hZGQuZXhpc3RpbmcocHJpemVCb3gsIHRydWUpOwogIH0KCiAgc3RhcnRNZW51SW1hZ2UgPSB0aGlzLmFkZC5pbWFnZSg0MDAsIDMwMCwgJ3N0YXJ0TWVudScpLnNldERlcHRoKDIwKTsKICBzdGFydE1lbnVJbWFnZS5zZXRJbnRlcmFjdGl2ZSgpLm9uKCdwb2ludGVyZG93bicsICgpID0-IHsKICAgIHN0YXJ0TWVudUltYWdlLnNldFZpc2libGUoZmFsc2UpOwogIH0pOwoKICAvLyBFc2NhcGUgQnV0dG9uIChib3R0b20tbGVmdCkKICBjb25zdCBlc2NCdXR0b24gPSB0aGlzLmFkZC50ZXh0KDEwLCA1NjAsICdFWElUJywgewogICAgZm9udFNpemU6ICcyNHB4JywgYmFja2dyb3VuZENvbG9yOiAnIzIyMicsIGNvbG9yOiAnI2ZmZicsIHBhZGRpbmc6IHsgeDogMTAsIHk6IDUgfQogIH0pLnNldEludGVyYWN0aXZlKCkuc2V0RGVwdGgoMjEpOwogIGVzY0J1dHRvbi5vbigncG9pbnRlcmRvd24nLCAoKSA9PiB7CiAgICBpZiAoIXF1aXRQb3B1cCkgc2hvd1F1aXRQb3B1cCgpOwogIH0pOwoKICAvLyBDbGF3IEFjdGlvbiBCdXR0b24gKGJvdHRvbSBjZW50ZXIpCiAgY29uc3QgY2xhd0J1dHRvbiA9IHRoaXMuYWRkLnRleHQoMTUwLCA1NTAsICdHUkFCIC8gRFJPUCcsIHsKICAgIGZvbnRTaXplOiAnMjRweCcsIGJhY2tncm91bmRDb2xvcjogJyNmMDAnLCBjb2xvcjogJyNmZmYnLCBwYWRkaW5nOiB7IHg6IDIwLCB5OiAxMCB9CiAgfSkuc2V0SW50ZXJhY3RpdmUoKS5zZXREZXB0aCgyMSk7CiAgY2xhd0J1dHRvbi5vbigncG9pbnRlcmRvd24nLCAoKSA9PiB7CiAgICBpZiAoIXN0YXJ0TWVudUltYWdlLnZpc2libGUpIGhhbmRsZUNsYXdBY3Rpb24oKTsKICB9KTsKCiAgLy8gVG91Y2ggZHJhZyBmb3IgY2xhdyBtb3ZlbWVudAogIHRoaXMuaW5wdXQub24oJ3BvaW50ZXJtb3ZlJywgKHBvaW50ZXIpID0-IHsKICAgIGlmICghY2xhd0Ryb3BwaW5nICYmICFjbGF3UmV0cmFjdGluZykgewogICAgICBjbGF3LnggPSBQaGFzZXIuTWF0aC5DbGFtcChwb2ludGVyLngsIDUwLCA3NTApOwogICAgICBjbGF3SGl0Ym94LnggPSBjbGF3Lng7CiAgICB9CiAgfSk7CgogIC8vIEtleWJvYXJkIGNvbnRyb2xzCiAgdGhpcy5pbnB1dC5rZXlib2FyZC5vbigna2V5ZG93bi1MRUZUJywgKCkgPT4gewogICAgbW92ZUxlZnQgPSB0cnVlOwogICAgb3ZlcmxheS5zZXRUZXh0dXJlKCdvdmVybGF5X2xlZnQnKTsKICB9KTsKICB0aGlzLmlucHV0LmtleWJvYXJkLm9uKCdrZXl1cC1MRUZUJywgKCkgPT4gewogICAgbW92ZUxlZnQgPSBmYWxzZTsKICAgIG92ZXJsYXkuc2V0VGV4dHVyZSgnb3ZlcmxheV9pZGxlJyk7CiAgfSk7CiAgdGhpcy5pbnB1dC5rZXlib2FyZC5vbigna2V5ZG93bi1SSUdIVCcsICgpID0-IHsKICAgIG1vdmVSaWdodCA9IHRydWU7CiAgICBvdmVybGF5LnNldFRleHR1cmUoJ292ZXJsYXlfcmlnaHQnKTsKICB9KTsKICB0aGlzLmlucHV0LmtleWJvYXJkLm9uKCdrZXl1cC1SSUdIVCcsICgpID0-IHsKICAgIG1vdmVSaWdodCA9IGZhbHNlOwogICAgb3ZlcmxheS5zZXRUZXh0dXJlKCdvdmVybGF5X2lkbGUnKTsKICB9KTsKICB0aGlzLmlucHV0LmtleWJvYXJkLm9uKCdrZXlkb3duLVNQQUNFJywgKCkgPT4gewogICAgaWYgKHN0YXJ0TWVudUltYWdlICYmIHN0YXJ0TWVudUltYWdlLnZpc2libGUpIHsKICAgICAgc3RhcnRNZW51SW1hZ2Uuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIGhhbmRsZUNsYXdBY3Rpb24oKTsKICB9KTsKICB0aGlzLmlucHV0LmtleWJvYXJkLm9uKCdrZXlkb3duLUVTQycsICgpID0-IHsKICAgIGlmICghcXVpdFBvcHVwKSBzaG93UXVpdFBvcHVwKCk7CiAgfSk7CgogIC8vIFJFTU9WRUQgdGhpcy5pbnB1dC5vbigncG9pbnRlcmRvd24nKSBnbG9iYWwgYmxvY2sKfQoKICBmdW5jdGlvbiBoYW5kbGVDbGF3QWN0aW9uKCkgewogICAgaWYgKCFjbGF3RHJvcHBpbmcgJiYgIWNsYXdSZXRyYWN0aW5nICYmICFob2xkaW5nT2JqZWN0KSB7CiAgICAgIGNsYXdEcm9wcGluZyA9IHRydWU7CiAgICB9IGVsc2UgaWYgKGhvbGRpbmdPYmplY3QpIHsKICAgICAgZmFsbGluZ0dyb3VwLmFkZChhdHRhY2hlZFByaXplKTsKICAgICAgYXR0YWNoZWRQcml6ZS5zZXRWZWxvY2l0eVkoMzAwKTsKICAgICAgaG9sZGluZ09iamVjdCA9IGZhbHNlOwogICAgICBhdHRhY2hlZFByaXplID0gbnVsbDsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHVwZGF0ZSgpIHsKICAgIGlmICh2aWN0b3J5KSByZXR1cm47CgogICAgaWYgKG1vdmVMZWZ0ICYmICFjbGF3RHJvcHBpbmcgJiYgIWNsYXdSZXRyYWN0aW5nKSB7CiAgICAgIGNsYXcueCA9IGNsYXdIaXRib3gueCA9IE1hdGgubWF4KDUwLCBjbGF3LnggLSA1KTsKICAgIH0KICAgIGlmIChtb3ZlUmlnaHQgJiYgIWNsYXdEcm9wcGluZyAmJiAhY2xhd1JldHJhY3RpbmcpIHsKICAgICAgY2xhdy54ID0gY2xhd0hpdGJveC54ID0gTWF0aC5taW4oNzUwLCBjbGF3LnggKyA1KTsKICAgIH0KCiAgICBpZiAoY2xhd0Ryb3BwaW5nKSB7CiAgICAgIGNsYXcueSArPSA0OwogICAgICBjbGF3SGl0Ym94LnkgKz0gNDsKICAgICAgcHJpemVHcm91cC5jaGlsZHJlbi5pdGVyYXRlKChwcml6ZSkgPT4gewogICAgICAgIGlmIChQaGFzZXIuR2VvbS5JbnRlcnNlY3RzLlJlY3RhbmdsZVRvUmVjdGFuZ2xlKGNsYXdIaXRib3guZ2V0Qm91bmRzKCksIHByaXplLmdldEJvdW5kcygpKSkgewogICAgICAgICAgYXR0YWNoZWRQcml6ZSA9IHByaXplOwogICAgICAgICAgaG9sZGluZ09iamVjdCA9IHRydWU7CiAgICAgICAgICBjbGF3RHJvcHBpbmcgPSBmYWxzZTsKICAgICAgICAgIGNsYXdSZXRyYWN0aW5nID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAoY2xhdy55ID49IDUwMCAmJiAhaG9sZGluZ09iamVjdCkgewogICAgICAgIGNsYXdEcm9wcGluZyA9IGZhbHNlOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gY2xhd1JldHJhY3RpbmcgPSB0cnVlLCA1MDApOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGNsYXdSZXRyYWN0aW5nKSB7CiAgICAgIGNsYXcueSAtPSAzOwogICAgICBjbGF3SGl0Ym94LnkgLT0gMzsKICAgICAgaWYgKGNsYXcueSA8PSA1MCkgewogICAgICAgIGNsYXdSZXRyYWN0aW5nID0gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoaG9sZGluZ09iamVjdCAmJiBhdHRhY2hlZFByaXplKSB7CiAgICAgIGF0dGFjaGVkUHJpemUueCA9IGNsYXcueDsKICAgICAgYXR0YWNoZWRQcml6ZS55ID0gY2xhdy55ICsgMTkwOwogICAgfQoKICAgIGZhbGxpbmdHcm91cC5jaGlsZHJlbi5pdGVyYXRlKChwcml6ZSkgPT4gewogICAgICBpZiAoUGhhc2VyLkdlb20uSW50ZXJzZWN0cy5SZWN0YW5nbGVUb1JlY3RhbmdsZShwcml6ZS5nZXRCb3VuZHMoKSwgcHJpemVCb3guZ2V0Qm91bmRzKCkpKSB7CiAgICAgICAgZGVzdHJveUFsbFByaXplcygpOwogICAgICAgIHNob3dWaWN0b3J5U2NyZWVuLmNhbGwodGhpcyk7CiAgICAgIH0gZWxzZSBpZiAocHJpemUueSA-PSA1NjApIHsKICAgICAgICBwcml6ZS5zZXRWZWxvY2l0eVkoMCk7CiAgICAgIH0KICAgIH0pOwogIH0KICBmdW5jdGlvbiBkZXN0cm95QWxsUHJpemVzKCkgewogIGZhbGxpbmdHcm91cC5jaGlsZHJlbi5lYWNoKGNoaWxkID0-IHsKICAgIGNoaWxkLmRlc3Ryb3koKTsKICB9KTsKfQogIGZ1bmN0aW9uIHNob3dWaWN0b3J5U2NyZWVuKCkgewogICAgdmljdG9yeSA9IHRydWU7CiAgICB0aGlzLmFkZC5pbWFnZSg0MDAsIDMwMCwgJ3ZpY3RvcnlCZycpLnNldERlcHRoKDIxKTsKICAgIHRoaXMuYWRkLnRleHQoNDAwLCAxNTAsICdZb3UgV2luIScsIHsKICAgICAgZm9udFNpemU6ICc2NHB4JywKICAgICAgY29sb3I6ICcjZmZmJwogICAgfSkuc2V0T3JpZ2luKDAuNSkuc2V0RGVwdGgoMjIpOwoKICAgIGNvbnN0IGNsYWltUHJpemVCdXR0b24gPSB0aGlzLmFkZC50ZXh0KDQwMCwgMjQwLCAnTWludCBQcml6ZScsIHsKICAgICAgZm9udFNpemU6ICcyOHB4JywgYmFja2dyb3VuZENvbG9yOiAnI2ZmMCcsIGNvbG9yOiAnIzAwMCcsIHBhZGRpbmc6IHsgeDogMTAsIHk6IDUgfQogICAgfSkuc2V0T3JpZ2luKDAuNSkuc2V0SW50ZXJhY3RpdmUoKS5zZXREZXB0aCgyMik7CgogICAgY29uc3QgbWludEJ1dHRvbiA9IHRoaXMuYWRkLnRleHQoNDAwLCAzMDAsICdNaW50IE5GVCcsIHsKICAgICAgZm9udFNpemU6ICczMnB4JywKICAgICAgYmFja2dyb3VuZENvbG9yOiAnI2ZmZicsCiAgICAgIGNvbG9yOiAnIzAwMCcsCiAgICAgIHBhZGRpbmc6IHsgeDogMTAsIHk6IDUgfQogICAgfSkuc2V0T3JpZ2luKDAuNSkuc2V0SW50ZXJhY3RpdmUoKS5zZXREZXB0aCgyMik7CgogICAgY29uc3QgcmVzdGFydEJ1dHRvbiA9IHRoaXMuYWRkLnRleHQoNDAwLCAzNjAsICdSZXN0YXJ0JywgewogICAgICBmb250U2l6ZTogJzI4cHgnLCBiYWNrZ3JvdW5kQ29sb3I6ICcjY2NjJywgY29sb3I6ICcjMDAwJywgcGFkZGluZzogeyB4OiAxMCwgeTogNSB9CiAgICB9KS5zZXRPcmlnaW4oMC41KS5zZXRJbnRlcmFjdGl2ZSgpLnNldERlcHRoKDIyKTsKCiAgICBjbGFpbVByaXplQnV0dG9uLm9uKCdwb2ludGVyZG93bicsIGFzeW5jICgpID0-IHsKICB0cnkgewogICAgaWYgKHR5cGVvZiB3aW5kb3cuZXRoZXJldW0gPT09ICd1bmRlZmluZWQnKSB7CiAgICAgIGFsZXJ0KCJNZXRhTWFzayBpcyBub3QgZGV0ZWN0ZWQuIFBsZWFzZSBpbnN0YWxsIE1ldGFNYXNrIHRvIGNvbnRpbnVlLiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gUmVxdWVzdCBhY2NvdW50IGFjY2VzcyBhbmQgc2V0IHByb3ZpZGVyL3NpZ25lcgogICAgY29uc3QgcHJvdmlkZXIgPSBuZXcgZXRoZXJzLnByb3ZpZGVycy5XZWIzUHJvdmlkZXIod2luZG93LmV0aGVyZXVtLCAiYW55Iik7CiAgICBhd2FpdCBwcm92aWRlci5zZW5kKCJldGhfcmVxdWVzdEFjY291bnRzIiwgW10pOwogICAgY29uc3Qgc2lnbmVyID0gcHJvdmlkZXIuZ2V0U2lnbmVyKCk7CgogICAgY29uc3QgY29udHJhY3RBZGRyZXNzID0gIjB4Y2FCNTQzRjZBZjM2NWE5RTc1ZjU2ZTdGYzg1RDlDODRGMTQ4MkIxMiI7CiAgICBjb25zdCBhYmkgPSBbImZ1bmN0aW9uIG1pbnRQcml6ZSgpIHB1YmxpYyJdOwoKICAgIGNvbnN0IGNvbnRyYWN0ID0gbmV3IGV0aGVycy5Db250cmFjdChjb250cmFjdEFkZHJlc3MsIGFiaSwgc2lnbmVyKTsKCiAgICAvLyBUcmlnZ2VyIG1pbnQKICAgIGNvbnN0IHR4ID0gYXdhaXQgY29udHJhY3QubWludFByaXplKCk7CiAgICBjb25zb2xlLmxvZygiVHJhbnNhY3Rpb24gc2VudDoiLCB0eC5oYXNoKTsKCiAgICBhd2FpdCB0eC53YWl0KCk7CiAgICBhbGVydCgi8J-OiSBQcml6ZSBtaW50ZWQgc3VjY2Vzc2Z1bGx5ISIpOwogIH0gY2F0Y2ggKGVycikgewogICAgY29uc29sZS5lcnJvcigiTWludGluZyBmYWlsZWQ6IiwgZXJyKTsKICAgIGlmIChlcnIuY29kZSA9PT0gNDAwMSkgewogICAgICBhbGVydCgiVHJhbnNhY3Rpb24gcmVqZWN0ZWQgYnkgdXNlci4iKTsKICAgIH0gZWxzZSB7CiAgICAgIGFsZXJ0KCJNaW50aW5nIGZhaWxlZC4gU2VlIGNvbnNvbGUgZm9yIGRldGFpbHMuIik7CiAgICB9CiAgfQp9KTsKICAgIG1pbnRCdXR0b24ub24oJ3BvaW50ZXJkb3duJywgKCkgPT4gewogICAgICB3aW5kb3cub3BlbigiaHR0cHM6Ly9vcGVuc2VhLmlvL2NvbGxlY3Rpb24vaGVhcnRib25lcyIsICdfYmxhbmsnKTsKICAgICAgZ2FtZS5kZXN0cm95KHRydWUpOwogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICJodHRwczovL3d3dy5mdW5mYXJ0Z2FtZXMuY29tL3RoYW5rcy1mb3ItcGxheWluZyI7CiAgICB9KTsKCiAgICByZXN0YXJ0QnV0dG9uLm9uKCdwb2ludGVyZG93bicsICgpID0-IHsKICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICB9KTsKICB9Cjwvc2NyaXB0PgogIDxkaXYgaWQ9InJvb3QiPjwvZGl2Pgo8L2JvZHk-CjwvaHRtbD4
